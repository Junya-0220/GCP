# VPC

## 26 GoogleCloudのネットワーク

### GoogleCloudの巨大なネットワーク

google検索やGmail、YouTubeといったGoogleのサービスを支える巨大なネットワークインフラは、
毎年巨額の投資が行われており、より高いパフォーマンスを目指して日々進化を続けています。
Google Cloudのネットワークには、Googleのサービスを支えるネットワークと同じものが使用されています。
Google Cloudのネットワークには、次のような特徴があります。

* より安全により高速に

Google独自の技術によって最適化された、グローバルでハイパフォーマンスなネットワーク、安全に利用できます。

* 拡張性と柔軟性

 googleのネットワークは多くの機能が、ソフトウェアによってネットワークを定義する技術である
 SDN (Software Defined Network)よって実現されており、高い拡張性と柔軟性があります。

### Googleのネットワークサービスを理解するには

本書の内容を理解するには、リージョンを選ぶポイントを押さえておく必要があります。
多くのGoogle Cloudのサービスは、初期設定にリージョンやゾーンを指定する必要がありますが、
これは、これから解説するネットワークサービス(VPC)でも同様です。
「 エンドユーザーから物理的に最も近いリージョンはどこか」「 海外のリージョンを利用しても良いのか」といった
 内容を事前に調査して、どのリージョンゾーンでホストするのかを決める必要があります。

### GoogleCloudにおけるデフォルトの設計

google Cloudでは何らかのサービスの利用する際、いきなり高度なネットワーク設定をユーザに求める事はありません。
リソースの作成と同時に、ネットワークの設定を裏側で行ってくれるサービスがほとんどです。
ユーザがよりスピード感を持って使えるよう、また注力したい部分にコストを避けるように様々な工夫がされています。
「すぐ試したい」「まずは小さなスケールで検証したい」といった場合は、デフォルトの設定を使って作りたいシステムが実現できそうかを判断すると良いでしょう。

### まとめ

 google CloudはGmailやYouTubeと同じネットワークインフラを使用している
 googleクラウドのネットワークには、安全で拘束高い拡張性と柔軟性などの特徴がある
 ネットワークサービスを理解するには、リージョンやゾーンの理解が必須

## 27 VPC 仮想ネットワークサービス

### VPCとは

Virtual Private Cloud(VPC)は、 google Cloud内に論理的に構成された仮想ネットワークを提供するサービスです。
VPCは、 クラウド上のリソースやサービスに、グローバルなネットワーキングを提供します。
また拡張性と柔軟性に優れており、セキュアなネットワークの設定が簡単に行えます。
ここでは、VPCに用意されている機能を紹介します。
クラウドに限らず、インフラの運用経験がある人には、お馴染みの機能もあるでしょう。

* VPCの機能一覧

| サービス名 | 概要 |
| --- | --- |
| VPCネットワーク | GoogleCloud内に構成される仮想ネットワーク |
| 外部IPアドレス | 主にインターネットへのアクセスに使うIPアドレス(外部IPアドレス) |
| ファイアウォール | 接続の許可または拒否を行う |
| ルート | ルーティングの設定 |
| VPCネットワークピアリング | VPCネットワーク同士の接続 |
| 共有VPC | 異なるプロジェクトでVPCを共有 |
| サーバーレスVPCアクセス | サーバーレスなGoogleCloudサービスからのVPCへの接続 |
| パケットのミラーリング | 検査用にトラフィックのクローンを作成 |

### VPCネットワーク

VPCネットワークとは、 google Cloud内に構成される、仮想ネットワークのことです。
VPCの中心となる機能で、VPC ネットワークのことを指してVPCと呼ぶ場合もあります。
VPCネットワークは、Andromedaと 呼ばれるGoogle独自の技術を活用したネットワークです。
VPC ネットワークを使用すると、複数のサブネットをルーターで接続した、物理ネットワークと同等のグローバルネットワークが構成可能です。
なお、1つのVPCネットワークには複数のリージョンを収容できます。

### Google Cloudのコンピューティングサービスをつなぐ

VPC ネットワークは主に、コンピューティングサービスであるComputeEngineインスタンスやGoogle Kubernetes Engine(コンテナ)、
App Engineフレキシブル環境に対するネットワーキングを提供します。
仮想マシンやコンテナを作成または起動すると、作成時に紐付けられたVPCネットワークのサブネットのIPアドレスから、内部IPが自動的に割り当てられます。
この内部IPが割り当てられることで、マシン同士の通信が可能になります。
なお、VPCネットワーク内の特定の内部IPを固定的に割り当てることも可能です。

### リソース同士の通信

仮想マシン などのリソース同士は、同じVPCネットワークを使用していれば、
異なるサブネットに属していても特別なルーティングの設定なしに通信が可能です。
しかし、異なるブイPCネットワーク間で通信を行いたい場合は、VPCネットワークピアリングの設定が必要です。
(他にもクラウドVPNを使った接続方法などがあります)

### まとめ

VPCは、 google Cloudの論理的に構成された仮想ネットワークを提供するサービス
VPC ネットワークとは、Google Cloud内に構成される仮想ネットワークのこと。
同じVPC ネットワークを使用していれば、異なるサブネットに属していても特別なルーティングの設定なしに通信が可能

## 28 デフォルトネットワーク

### 「default」という名前のVPCネットワーク

